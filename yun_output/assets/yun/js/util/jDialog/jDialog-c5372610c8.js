!function(t,e){function i(t){var e=t,i=e.getWrapper(),n=e.options;return i.appendChild(e.getHeader()),i.appendChild(e.getContainer()),i.appendChild(e.getFooter()),""===n.title&&e.hideHeader(),e.title(n.title),n.url?e.iframe(n.url):e.content(n.content),e.addButton("取消","destory",function(){e.remove()}),n.modal&&e.showModal(),n.autoHide&&e.autoHide(n.autoHide),n.callBack&&e.addButton("确定","apply",n.callBack),i.addEventListener("click",o.bind(e),!1),i.addEventListener("touchstart",r,!1),i.addEventListener("touchend",r,!1),l.body.appendChild(i),e.verticalInViewPort(n.fixed).addClass("dialog-zoom-in"),e}function n(t,e){var i=l.createElement(t);return p.extend(i,e),i}function o(t){var e=t.target,i=e.getAttribute("data-dialog-action");i&&p.event.fire(i,e)}function r(t){var e=t.target,i=e.getAttribute("data-dialog-action");i&&e.classList.toggle("active")}function s(t){var e=t,i=n("div");return i.style.cssText=";background:rgba(0,0,0,0.3);height:100%;width:100%;position:absolute;left:0;top:0;right:0;bottom:0;z-index:"+(e.currentDOMIndex-1),i.onclick=function(){e.options.preventHide||p.event.fire("destory")},l.body.appendChild(i)}function a(t){return"[object Function]"===Object.prototype.toString.call(t)}function d(t){return null!==t&&void 0!==t&&t.constructor=={}.constructor}function h(t){var e=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return e.test(t)}var u=t,l=e,c="1.0.0",p=function(t,e){return new p.fn.init(t,e)};p.fn=p.prototype={constructor:p,init:function(t,e){if(this.options={title:"提示",modal:!0,content:"",autoHide:0,prefix:"",fixed:!0,preventHide:!1,callBack:null,url:null},this.buttons=[],p.event.root=this,p.currentDialog&&p.currentDialog.remove(),p.currentDialog=this,d(t))p.extend(this.options,t);else{if(!/string|number|boolean/gi.test(typeof t))return this;this.options.content=t,a(e)&&(this.options.callBack=e)}return i(this),this}},p.extend=p.fn.extend=function(){var t,e,i=arguments[0]||{},n=arguments[1]||{};1===arguments.length&&(i=this,n=arguments[0]);for(t in n)e=n[t],void 0!==e&&(i[t]=e);return i},p.fn.init.prototype=p.fn,p.extend({expando:"jDialog"+(c+Math.random()).replace(/\D/g,"")}),p.event={actions:{},add:function(t,e){return a(e)&&(this.actions[t]=e),this},remove:function(t){return!!this.has(t)&&delete this.actions[t]},has:function(t){return!("string"!=typeof t||!this.actions[t])},once:function(t){return this.has(t)&&this.fire(t).remove(t),this},fire:function(t,e){return this.has(t)&&this.actions[t].call(p.currentDialog||p(),e),this}},p.fn.extend({verticalInViewPort:function(t){var e=l.documentElement,i=e.clientHeight,n=this.height();if(t)n>i&&(n=.75*i,this.getContainer().style.height=n-(this.height(this.getHeader())+this.height(this.getFooter()))+"px"),this.height("").toggleLockBody(!0).extend(this.getWrapper().style,{position:"fixed"});else{var o=Math.max(l.body.scrollTop,e.scrollTop),r=Math.max(382*(i-n)/1e3+o,o);this.top(r).height("auto").toggleLockBody(!1).getContainer().style.height="auto"}return this},toggleLockBody:function(t){var e=this.getHeader(),i=this.getFooter(),n=this.getModal(),o="ontouchmove";return t?e[o]=i[o]=n[o]=function(){return!1}:e[o]=i[o]=n[o]=null,this},getWrapper:function(){if(!this.wrapper){var t=this.options.prefix;this.wrapper=n("div",{className:t+"du-dialog"}),this.wrapper.style.zIndex=this.currentDOMIndex=9999}return this.wrapper},getHeader:function(){if(!this.header){var t=this.options.prefix;this.header=n("div",{className:t+"du-dialog-hd"})}return this.header},hideHeader:function(){var t=this.getHeader(),e=this.height(t);return this.height(this.height()-e),this.getWrapper().removeChild(t),this},getContainer:function(){if(!this.container){var t=this.options.prefix;this.container=n("div",{className:t+"du-dialog-bd"})}return this.container},getFooter:function(){if(!this.footer){var t=this.options.prefix;this.footer=n("div",{className:t+"du-dialog-ft"})}return this.footer},hideFooter:function(){var t=this.getFooter(),e=this.height(t);return this.height(this.height()-e),t.style.display="none",this},addButton:function(t,e,i){var o=("jDialog"+Math.random()).replace(/\D/g,""),r="确定";if(a(t))return this.addButton(r,e||o,t);if(a(e))return this.addButton(t,o,e);var s=this.options.prefix,d=n("a",{href:"javascript:void(0)",className:s+"du-dialog-btn",innerHTML:t||r});e?p.event.add(e,i):e="destory",d.setAttribute("data-dialog-action",e);var h=this.getFooter();return this.buttons.length?(this.addClass("du-dialog-btn-primary",d),h.insertBefore(d,h.childNodes.item(0))):(this.addClass("du-dialog-btn-default",d),h.appendChild(d)),this.buttons.push(d),this},delButton:function(t){var e,i=this.getButton(t);if(i){e=i.getAttribute("data-dialog-action"),"destory"!=e&&p.event.remove(e),this.getFooter().removeChild(i);var n=this.buttons.indexOf(i);this.buttons.splice(n,1)}return this},getButton:function(t){var e=this.buttons.slice().reverse();return e[t]?e[t]:null},addClass:function(t,e){return e=e||this.getWrapper(),1===e.nodeType&&"string"==typeof t&&e.classList.add(t),this},removeClass:function(t,e){return e=e||this.getWrapper(),1===e.nodeType&&"string"==typeof t&&e.classList.remove(t),this},autoHide:function(t){return p.currentDialog?0==t?this.remove():void 0===t?this.autoHide(this.options.autoHide):(this.autoHideTimer&&clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){this.remove(),clearTimeout(this.autoHideTimer),this.autoHideTimer=null}.bind(this),1e3*t),this):this},remove:function(){return this.toggleLockBody(!1),this.wrapper&&(this.wrapper.removeEventListener("click",o,!1),this.wrapper.addEventListener("touchstart",r,!1),this.wrapper.addEventListener("touchend",r,!1),l.body.removeChild(this.wrapper)),this.modal&&(this.modal.onclick=null,l.body.removeChild(this.modal)),this.autoHideTimer&&clearTimeout(this.autoHideTimer),p.currentDialog=this.buttons=this.container=this.footer=this.header=this.options=this.wrapper=this.modal=null,this},getModal:function(){return this.modal||(this.modal=s(this)),this.modal},hideModal:function(){return this.getModal().style.display="none",this},showModal:function(){return this.getModal().style.display="",this},iframe:function(t){var e=this,i=t||e.options.url,o=null;if(d(t)&&(i=t.url,o=t.callBack),!h(i))return e.content(i+"不是一个有效的地址");var r=e.getContainer(),s=l.documentElement.clientHeight,a=n("div");a.style.cssText="height:5px;width:10%;opacity:1;margin-bottom:1em;background:#1abc9c;-webkit-transition:width ease-in 2s",r.appendChild(a);var u=n("iframe",{width:"100%",height:s});return u.frameborder=0,u.onload=function(){a.style.width="100%",o&&o.call(e,!0),u.onload=a=null},u.onerror=function(){e.content("加载"+i+"时发生错误"),u.onload=a=null},r.appendChild(u),u.src=i,e}});var g=function(t){return/em|px|rem|pt|%|auto/gi.test(t)||(t+="px"),t};p.fn.extend({title:function(t){return"undefined"==typeof t?this.options.title:(this.getHeader().innerHTML=this.options.title=t,this)},content:function(t){return void 0===t?this.options.content:(this.getContainer().innerHTML=this.options.content=t,this)},height:function(t){return void 0===t?this.height(this.getWrapper()):1===t.nodeType?t.offsetHeight:(this.wrapper.style.height=g(t),this)},width:function(t){return void 0===t?this.width(this.getWrapper()):1===t.nodeType?t.offsetWidth:(p.extend(this.wrapper.style,{width:g(t),marginLeft:g(-(parseFloat(t)/2))}),this)},index:function(t){return void 0===t?this.currentDOMIndex:(this.currentDOMIndex=t,this.wrapper.style.zIndex=this.currentDOMIndex,this.getModal().style.zIndex=this.currentDOMIndex-1,this)},top:function(t){return void 0===t?u.getComputedStyle(this.getWrapper()).top:(p.extend(this.wrapper.style,{top:g(t),marginTop:""}),this)},fixed:function(t){var e=!0;return t&&"undefined"==typeof t||(e=!1,this.getWrapper().style.position="absolute"),this.verticalInViewPort(e)},absolute:function(){return this.fixed(!1)},preventHide:function(){return this.options.preventHide=!0,this}}),p.extend({alert:function(t){return p(t)},toast:function(t,e){var i=p(t).addClass("du-dialog-toast");return i.getContainer().style.textAlign="center",i.hideFooter().hideHeader().hideModal().height("auto").autoHide(e||3),i},ad:function(t){var t=t||"",e='<div class="thumb-outer">'+t+'</div><div class="dialog-close" title="关闭"><b data-dialog-action="destory" class="iconfont icon-cancel01"></b></div>',i=p(e).hideFooter().hideHeader().addClass("du-dialog-ad").preventHide().height("auto"),n=i.getModal();return n.style.backgroundColor="rgba(0,0,0,0.7)",i},loading:function(t){var t=t||"a",e='<div class="thumb-outer thumb-outer-'+t+'"><div class="thumb-inner"></div></div>',i=p(e).hideFooter().hideHeader().addClass("du-dialog-loading").preventHide().height("auto"),n=i.getModal();return n.style.backgroundColor="rgba(0,0,0,0)",i},error:function(t,e){return p(t,e).addClass("du-dialog-error")}}),"function"==typeof define&&define.amd?define(function(){return p}):u.jDialog=p}(window,window.document);